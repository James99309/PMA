# PMA系统国际化功能使用说明

## 功能概述

PMA系统现已支持中英文界面切换功能，用户可以根据需要在简体中文和英文之间自由切换。

## 支持的语言

- **简体中文** (zh_CN) - 默认语言
- **English** (en) - 英文

## 如何切换语言

### 方法1：通过用户菜单切换

1. 登录系统后，点击右上角的用户头像或用户名
2. 在下拉菜单中找到"语言设置"选项
3. 选择"简体中文"或"English"
4. 页面将自动刷新并应用新的语言设置

### 方法2：通过API切换

发送POST请求到 `/language/switch`：

```json
{
    "language": "en"  // 或 "zh_CN"
}
```

## 语言偏好保存

- 语言设置会自动保存到用户账户中
- 下次登录时会自动应用上次选择的语言
- 如果用户未设置语言偏好，系统会根据浏览器语言自动选择

## 已国际化的模块

### 客户管理模块

- 客户列表和详情页面
- 添加/编辑客户表单
- 客户状态和行业选项
- 国家名称显示
- 操作提示消息

### 系统界面

- 导航菜单
- 用户菜单
- 基本操作按钮
- 状态消息

## 演示页面

访问 `/customer/i18n-demo` 可以查看国际化功能的演示页面，展示：

- 客户基本信息的多语言显示
- 操作按钮的国际化
- 状态消息的翻译效果
- 当前语言显示

## 开发者信息

### 文件结构

```
app/
├── translations/           # 翻译文件目录
│   └── en/
│       └── LC_MESSAGES/
│           ├── messages.po # 英文翻译源文件
│           └── messages.mo # 编译后的翻译文件
├── utils/
│   ├── i18n.py            # 国际化工具模块
│   └── country_names.py   # 国家名称翻译
└── views/
    └── language.py        # 语言切换视图
```

### 添加新翻译

1. 在代码中使用 `_('文本')` 包装需要翻译的文本
2. 更新翻译文件：`pybabel extract -F babel.cfg -o messages.pot .`
3. 更新英文翻译：`pybabel update -i messages.pot -d app/translations`
4. 编辑 `app/translations/en/LC_MESSAGES/messages.po` 添加翻译
5. 编译翻译文件：`pybabel compile -d app/translations`

### 技术实现

- 使用 Flask-Babel 进行国际化支持
- 语言选择优先级：session > 用户偏好 > 浏览器语言 > 默认中文
- 支持动态语言切换，无需重启应用
- 翻译文件使用标准的GNU gettext格式

## 注意事项

1. 切换语言后页面会自动刷新以应用新的语言设置
2. 语言偏好与用户账户绑定，不同用户可以有不同的语言设置
3. 如果翻译文件缺少某些文本的翻译，将显示原始中文文本
4. 新增翻译后需要重新编译翻译文件才能生效

## 版本信息

- 初始版本：支持中英文切换
- 实现模块：客户管理模块
- 技术栈：Flask-Babel + GNU gettext 