# æ•°æ®åº“ç»“æ„åŒæ­¥å®ŒæˆæŠ¥å‘Š

## ğŸ“… åŒæ­¥æ—¶é—´
- **å¼€å§‹æ—¶é—´**: 2025-06-18 23:00:11
- **å®Œæˆæ—¶é—´**: 2025-06-18 23:01:10
- **æ€»è€—æ—¶**: çº¦1åˆ†é’Ÿ

## ğŸ¯ åŒæ­¥ç›®æ ‡
å°†æœ¬åœ°æ•°æ®åº“ `pma_local` çš„æœ€æ–°æ•°æ®ç»“æ„åŒæ­¥åˆ°äº‘ç«¯æ•°æ®åº“ `pma_db_sp8d`ï¼Œç¡®ä¿äº‘ç«¯ç»“æ„ä¸æœ¬åœ°æ•°æ®åº“ç»“æ„ä¸€è‡´ï¼ŒåŒæ—¶ä¿è¯ä¸è¯¯åˆ äº‘ç«¯çš„ä»»ä½•æ•°æ®ã€‚

## âœ… åŒæ­¥ç»“æœæ¦‚è§ˆ
- **æœ¬åœ°è¡¨æ•°é‡**: 53å¼ è¡¨
- **äº‘ç«¯è¡¨æ•°é‡**: 53å¼ è¡¨
- **æ–°å¢è¡¨**: 0å¼ ï¼ˆè¡¨ç»“æ„å®Œå…¨ä¸€è‡´ï¼‰
- **æ–°å¢åˆ—**: 4ä¸ªï¼ˆå·²æˆåŠŸæ·»åŠ ï¼‰
- **æ›´æ–°é»˜è®¤å€¼**: 36ä¸ªå­—æ®µï¼ˆå·²æˆåŠŸæ›´æ–°ï¼‰
- **æ•°æ®å®‰å…¨æ€§**: âœ… å®Œå…¨å®‰å…¨ï¼Œæ— æ•°æ®æŸå¤±

## ğŸ“ å…·ä½“æ›´æ–°å†…å®¹

### 1. æ–°å¢åˆ—ï¼ˆ4ä¸ªï¼‰
| è¡¨å | åˆ—å | æ•°æ®ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|----------|--------|------|
| `dictionaries` | `is_vendor` | boolean | false | æ ‡è¯†æ˜¯å¦ä¸ºä¾›åº”å•†å­—å…¸ |
| `role_permissions` | `pricing_discount_limit` | double precision | NULL | æ‰¹ä»·æŠ˜æ‰£æƒé™é™åˆ¶ |
| `role_permissions` | `settlement_discount_limit` | double precision | NULL | ç»“ç®—æŠ˜æ‰£æƒé™é™åˆ¶ |
| `users` | `language_preference` | varchar(10) | NULL | ç”¨æˆ·è¯­è¨€åå¥½è®¾ç½® |

### 2. æ›´æ–°é»˜è®¤å€¼ï¼ˆ36ä¸ªå­—æ®µï¼‰
æˆåŠŸä¸ºä»¥ä¸‹è¡¨çš„å­—æ®µè®¾ç½®äº†æ­£ç¡®çš„é»˜è®¤å€¼ï¼š

#### å®¡æ‰¹ç›¸å…³è¡¨
- `approval_process_template`: required_fields, lock_object_on_start, lock_reason
- `approval_step`: editable_fields, cc_users, cc_enabled

#### æ‰¹ä»·å•ç›¸å…³è¡¨  
- `pricing_orders`: is_direct_contract, is_factory_pickup

#### é¡¹ç›®è¯„åˆ†ç›¸å…³è¡¨
- `project_scoring_config`: score_value, is_active, created_at, updated_at
- `project_scoring_records`: score_value, auto_calculated, created_at, updated_at
- `project_total_scores`: æ‰€æœ‰è¯„åˆ†å­—æ®µå’Œæ—¶é—´æˆ³å­—æ®µ

#### é¡¹ç›®ç›¸å…³è¡¨
- `projects`: updated_at, is_locked, is_active, last_activity_date

#### æŠ¥ä»·ç›¸å…³è¡¨
- `quotation_details`: implant_subtotal
- `quotations`: approval_status, approved_stages, approval_history, is_locked, confirmation_badge_status, confirmation_badge_color, product_signature, implant_total_amount

## ğŸ” éªŒè¯ç»“æœ
åŒæ­¥å®Œæˆåè¿›è¡Œçš„éªŒè¯æ£€æŸ¥ï¼š
- âœ… è¡¨æ•°é‡ä¸€è‡´ï¼šæœ¬åœ°53å¼  = äº‘ç«¯53å¼ 
- âœ… æ–°å¢åˆ—éªŒè¯ï¼š`role_permissions`è¡¨æˆåŠŸæ·»åŠ 2ä¸ªæŠ˜æ‰£é™åˆ¶åˆ—
- âœ… æ–°å¢åˆ—éªŒè¯ï¼š`users`è¡¨æˆåŠŸæ·»åŠ `language_preference`åˆ—
- âœ… ç»“æ„ä¸€è‡´æ€§ï¼šç¬¬äºŒæ¬¡ç»“æ„æ¯”è¾ƒæ˜¾ç¤º0ä¸ªå·®å¼‚

## ğŸ›¡ï¸ å®‰å…¨æªæ–½
æœ¬æ¬¡åŒæ­¥é‡‡ç”¨äº†ä»¥ä¸‹å®‰å…¨æªæ–½ï¼š
1. **åªæ·»åŠ ä¸åˆ é™¤**ï¼šä»…æ‰§è¡ŒADD COLUMNå’ŒSET DEFAULTæ“ä½œ
2. **ä½¿ç”¨IF NOT EXISTS**ï¼šé¿å…é‡å¤æ·»åŠ åˆ—çš„é”™è¯¯
3. **ä¿ç•™æ‰€æœ‰æ•°æ®**ï¼šæœªæ‰§è¡Œä»»ä½•å¯èƒ½å½±å“ç°æœ‰æ•°æ®çš„æ“ä½œ
4. **åˆ†æ­¥éªŒè¯**ï¼šæ¯ä¸ªæ­¥éª¤éƒ½è¿›è¡Œäº†ç»“æœéªŒè¯
5. **å¤‡ä»½å…ˆè¡Œ**ï¼šåœ¨åŒæ­¥å‰å·²å®Œæˆäº‘ç«¯æ•°æ®åº“å®Œæ•´å¤‡ä»½

## ğŸ“‹ æ“ä½œè®°å½•
1. **ç»“æ„åˆ†æ**: ä½¿ç”¨Pythonè„šæœ¬æ¯”è¾ƒæœ¬åœ°å’Œäº‘ç«¯æ•°æ®åº“ç»“æ„å·®å¼‚
2. **DDLç”Ÿæˆ**: è‡ªåŠ¨ç”Ÿæˆå®‰å…¨çš„DDLåŒæ­¥è„šæœ¬
3. **æ‰‹åŠ¨å®¡æŸ¥**: äººå·¥å®¡æŸ¥æ‰€æœ‰DDLè¯­å¥ç¡®ä¿å®‰å…¨æ€§
4. **æ‰§è¡ŒåŒæ­¥**: åœ¨äº‘ç«¯æ•°æ®åº“æ‰§è¡Œ42æ¡ALTER TABLEè¯­å¥
5. **ç»“æœéªŒè¯**: é‡æ–°è¿è¡Œç»“æ„æ¯”è¾ƒç¡®è®¤åŒæ­¥æˆåŠŸ

## ğŸ‰ åŒæ­¥çŠ¶æ€
**çŠ¶æ€**: âœ… **å®Œå…¨æˆåŠŸ**
**ç»“è®º**: æœ¬åœ°æ•°æ®åº“ `pma_local` ä¸äº‘ç«¯æ•°æ®åº“ `pma_db_sp8d` çš„ç»“æ„ç°å·²å®Œå…¨ä¸€è‡´ï¼Œæ‰€æœ‰äº‘ç«¯æ•°æ®å®Œæ•´ä¿ç•™ã€‚

## ğŸ“ ç›¸å…³æ–‡ä»¶
- `db_backups/pma_db_sp8d_backup_20250618_225506.backup` - åŒæ­¥å‰çš„äº‘ç«¯æ•°æ®åº“å¤‡ä»½
- `db_backups/safe_schema_updates.sql` - æ‰§è¡Œçš„å®‰å…¨DDLè„šæœ¬
- `db_backups/schema_sync_ddl_20250618_230011.sql` - å®Œæ•´çš„ç»“æ„åˆ†ææŠ¥å‘Š
- `sync_schema_safely.py` - ç»“æ„æ¯”è¾ƒå·¥å…·è„šæœ¬ 